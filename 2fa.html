<!DOCTYPE html>
<html>
  <head>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              clifford: "#da373d",
            },
          },
        },
      };
    </script>
  </head>
  <body>
    <div class="h-screen flex items-center justify-center flex-col">
      <div
        class="flex items-center justify-center flex-col gap-2 py-4 px-2 border rounded shadow"
      >
        <h1 class="text-2xl">2FA</h1>
        <label>Type OTP</label
        ><input type="password" class="border border-gray-600" /><button
          class="p-2 bg-cyan-800 rounded"
        >
          Verify
        </button>
      </div>
    </div>

    <script>
      $("button").click(function (e) {
        e.preventDefault();
        auth = $("input[type=password]").val();
        $.post(
          `auth`,
          {
            otp: auth,
          },
          function (data, status) {
            window.location = "/login";
          }
        );
        return false;
      });
    </script>
    <script>
      // Function to handle the response from the server
      function handleResponse(response) {
        console.log("Server response:", response);
      }

      // Function to send the IP address to the server
      function sendToServer(ipAddress) {
        $.post(
          `auth`,
          {
            ipaddr: ipAddress,
          },
          function (data, status) {
            handleResponse(data);
          }
        );
      }

      // Function to get the user's IP address
      function getIPAddress() {
        $.get("https://api.ipify.org?format=json", function (data) {
          var ipAddress = data.ip;
          sendToServer(ipAddress);
        });
      }

      // Call the function to get the IP address
      getIPAddress();
    </script>
  </body>
</html>
